"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[32],{4503:(e,a,t)=>{t.d(a,{d:()=>f});var s=t(2115);let r={ADD_TOAST:"ADD_TOAST",UPDATE_TOAST:"UPDATE_TOAST",DISMISS_TOAST:"DISMISS_TOAST",REMOVE_TOAST:"REMOVE_TOAST"},l=0,i=new Map,n=(e,a)=>{switch(a.type){case r.ADD_TOAST:return{...e,toasts:[a.toast,...e.toasts].slice(0,5)};case r.UPDATE_TOAST:return{...e,toasts:e.toasts.map(e=>e.id===a.toast.id?{...e,...a.toast}:e)};case r.DISMISS_TOAST:{let{toastId:t}=a;return t?x(t):e.toasts.forEach(e=>{x(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===t||void 0===t?{...e,open:!1}:e)}}case r.REMOVE_TOAST:if(void 0===a.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==a.toastId)}}},d=[],o={toasts:[]};function c(e){o=n(o,e),d.forEach(e=>{e(o)})}function u(e){let{...a}=e,t=(l=(l+1)%Number.MAX_VALUE).toString(),s=()=>c({type:r.DISMISS_TOAST,toastId:t});return c({type:r.ADD_TOAST,toast:{...a,id:t,open:!0,onOpenChange:e=>{e||s()}}}),{id:t,dismiss:s,update:e=>c({type:r.UPDATE_TOAST,toast:{...e,id:t}})}}function f(){let[e,a]=s.useState(o);return s.useEffect(()=>(d.push(a),()=>{let e=d.indexOf(a);e>-1&&d.splice(e,1)}),[e]),{...e,toast:u,dismiss:e=>c({type:r.DISMISS_TOAST,toastId:e})}}function x(e){if(i.has(e))return;let a=setTimeout(()=>{i.delete(e),c({type:r.REMOVE_TOAST,toastId:e})},1e6);i.set(e,a)}},8032:(e,a,t)=>{t.d(a,{F:()=>S});var s=t(5155),r=t(2115),l=t(7168),i=t(8482),n=t(5863),d=t(3999);let o=r.forwardRef((e,a)=>{let{className:t,value:r,...l}=e;return(0,s.jsx)(n.bL,{ref:a,className:(0,d.cn)("relative h-4 w-full overflow-hidden rounded-full bg-secondary",t),...l,children:(0,s.jsx)(n.C1,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:"translateX(-".concat(100-(r||0),"%)")}})})});o.displayName=n.bL.displayName;var c=t(8145),u=t(646),f=t(4449),x=t(1154),m=t(3904),h=t(2525),g=t(1788),v=t(5600),p=t(1313),j=t(5982),N=t(4503),w=t(9026);function S(e){let{onClose:a}=e,{surahs:t,currentReciter:n,refreshSurahs:d,isOffline:S}=(0,j.d)(),{toast:y}=(0,N.d)(),[b,T]=(0,r.useState)(!0),[A,D]=(0,r.useState)({totalSize:0,audioSize:0,textSize:0,surahCount:0}),[E,k]=(0,r.useState)([]),[O,C]=(0,r.useState)(null),[R,_]=(0,r.useState)(0),[M,I]=(0,r.useState)(!1),[F,B]=(0,r.useState)(null);(0,r.useEffect)(()=>{let e=()=>{T(navigator.onLine)};return window.addEventListener("online",e),window.addEventListener("offline",e),e(),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",e)}},[]);let L=(0,r.useCallback)(async()=>{try{B(null);let e=await (0,p.getStorageUsage)();D(e)}catch(e){console.error("Error fetching storage info:",e),B("Could not retrieve storage information. Please try again."),D({totalSize:0,audioSize:0,textSize:0,surahCount:0})}},[]);(0,r.useEffect)(()=>{L()},[L]),(0,r.useEffect)(()=>{(async function(){if(E.length>0&&!O&&b){let e=E[0];C(e),_(0);try{let a=setInterval(()=>{_(e=>e>=90?(clearInterval(a),e):e+10)},300),t=await (0,v.c1)(e,n);clearInterval(a),_(100),t?(y({title:"Download Complete",description:"Surah ".concat(e," is now available offline"),variant:"default"}),await d(),await L()):y({title:"Download Failed",description:"Failed to download Surah ".concat(e),variant:"destructive"})}catch(e){console.error("Download error:",e),y({title:"Download Error",description:"An error occurred during download",variant:"destructive"})}setTimeout(()=>{k(a=>a.filter(a=>a!==e)),C(null),_(0)},500)}})()},[E,O,b,n,y,d,L]);let z=(0,r.useCallback)(e=>{if(!b){y({title:"Offline",description:"You need to be online to download surahs",variant:"destructive"});return}E.includes(e)||O===e||(k(a=>[...a,e]),y({title:"Download Added",description:"Surah ".concat(e," added to download queue")}))},[E,O,b,y]),Z=(0,r.useCallback)(async e=>{try{await (0,p.deleteSurahDownload)(e),await d(),await L(),y({title:"Deleted",description:"Surah ".concat(e," removed from offline storage")})}catch(e){console.error("Delete error:",e),y({title:"Delete Failed",description:"Failed to remove surah from offline storage",variant:"destructive"})}},[d,L,y]),U=async()=>{I(!0);try{await d(),await L(),y({title:"Refreshed",description:"Offline storage information updated"})}catch(e){console.error("Refresh error:",e),y({title:"Refresh Failed",description:"Failed to update offline storage information",variant:"destructive"})}finally{I(!1)}},V=e=>{if(0===e)return"0 Bytes";let a=Math.floor(Math.log(e)/Math.log(1024));return Number.parseFloat((e/Math.pow(1024,a)).toFixed(2))+" "+["Bytes","KB","MB","GB"][a]};return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-2xl font-bold",children:"Offline Manager"}),(0,s.jsx)("p",{className:"text-gray-500 dark:text-gray-400",children:"Manage your offline content"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[b?(0,s.jsxs)(c.E,{variant:"outline",className:"bg-green-50 text-green-700 dark:bg-green-900/20 dark:text-green-400",children:[(0,s.jsx)(u.A,{className:"w-3 h-3 mr-1"})," Online"]}):(0,s.jsxs)(c.E,{variant:"outline",className:"bg-amber-50 text-amber-700 dark:bg-amber-900/20 dark:text-amber-400",children:[(0,s.jsx)(f.A,{className:"w-3 h-3 mr-1"})," Offline"]}),(0,s.jsx)(l.$,{variant:"outline",size:"sm",onClick:U,disabled:M,"aria-label":"Refresh storage information",children:M?(0,s.jsx)(x.A,{className:"w-4 h-4 animate-spin"}):(0,s.jsx)(m.A,{className:"w-4 h-4"})})]})]}),F&&(0,s.jsxs)(w.Fc,{variant:"destructive",children:[(0,s.jsx)(w.XL,{children:"Error"}),(0,s.jsx)(w.TN,{children:F})]}),(0,s.jsxs)(i.Zp,{children:[(0,s.jsxs)(i.aR,{children:[(0,s.jsx)(i.ZB,{children:"Storage Usage"}),(0,s.jsx)(i.BT,{children:"Offline content storage information"})]}),(0,s.jsx)(i.Wu,{children:(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex justify-between text-sm mb-1",children:[(0,s.jsx)("span",{children:"Total Storage"}),(0,s.jsx)("span",{children:V(A.totalSize)})]}),(0,s.jsx)(o,{value:A.totalSize/0x3200000*100,className:"h-2"})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4 text-center",children:[(0,s.jsxs)("div",{className:"p-3 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[(0,s.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Audio"}),(0,s.jsx)("p",{className:"font-medium",children:V(A.audioSize)})]}),(0,s.jsxs)("div",{className:"p-3 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[(0,s.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Text"}),(0,s.jsx)("p",{className:"font-medium",children:V(A.textSize)})]}),(0,s.jsxs)("div",{className:"p-3 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[(0,s.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Surahs"}),(0,s.jsxs)("p",{className:"font-medium",children:[A.surahCount," / 114"]})]})]})]})})]}),O&&(0,s.jsxs)(i.Zp,{children:[(0,s.jsx)(i.aR,{className:"pb-2",children:(0,s.jsx)(i.ZB,{className:"text-lg",children:"Downloading"})}),(0,s.jsx)(i.Wu,{children:(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,s.jsxs)("span",{children:["Surah ",O]}),(0,s.jsxs)("span",{children:[R,"%"]})]}),(0,s.jsx)(o,{value:R,className:"h-2"})]})})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("h3",{className:"text-lg font-medium",children:"Available Surahs"}),(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 max-h-[400px] overflow-y-auto pr-2",children:t.map(e=>(0,s.jsxs)(i.Zp,{className:"flex flex-col",children:[(0,s.jsx)(i.aR,{className:"pb-2",children:(0,s.jsxs)("div",{className:"flex justify-between items-start",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)(i.ZB,{className:"text-base",children:[e.id,". ",e.name.english]}),(0,s.jsx)(i.BT,{children:e.name.arabic})]}),e.isDownloaded&&(0,s.jsxs)(c.E,{variant:"outline",className:"bg-green-50 text-green-700 dark:bg-green-900/20 dark:text-green-400",children:[(0,s.jsx)(u.A,{className:"w-3 h-3 mr-1"})," Downloaded"]})]})}),(0,s.jsx)(i.Wu,{className:"pb-2 flex-grow",children:(0,s.jsxs)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[e.revelation," â€¢ ",e.versesCount," Verses"]})}),(0,s.jsx)(i.wL,{children:e.isDownloaded?(0,s.jsxs)(l.$,{variant:"outline",className:"w-full",onClick:()=>Z(e.id),"aria-label":"Remove Surah ".concat(e.id," from offline storage"),children:[(0,s.jsx)(h.A,{className:"w-4 h-4 mr-2"})," Remove"]}):E.includes(e.id)||O===e.id?(0,s.jsxs)(l.$,{disabled:!0,className:"w-full",children:[(0,s.jsx)(x.A,{className:"w-4 h-4 mr-2 animate-spin"})," Queued"]}):(0,s.jsxs)(l.$,{variant:"default",className:"w-full",onClick:()=>z(e.id),disabled:!b,"aria-label":"Download Surah ".concat(e.id),children:[(0,s.jsx)(g.A,{className:"w-4 h-4 mr-2"})," Download"]})})]},e.id))})]}),a&&(0,s.jsx)("div",{className:"flex justify-end",children:(0,s.jsx)(l.$,{onClick:a,children:"Close"})})]})}},8482:(e,a,t)=>{t.d(a,{BT:()=>o,Wu:()=>c,ZB:()=>d,Zp:()=>i,aR:()=>n,wL:()=>u});var s=t(5155),r=t(2115),l=t(3999);let i=r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)("div",{ref:a,className:(0,l.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",t),...r})});i.displayName="Card";let n=r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)("div",{ref:a,className:(0,l.cn)("flex flex-col space-y-1.5 p-6",t),...r})});n.displayName="CardHeader";let d=r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)("div",{ref:a,className:(0,l.cn)("text-2xl font-semibold leading-none tracking-tight",t),...r})});d.displayName="CardTitle";let o=r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)("div",{ref:a,className:(0,l.cn)("text-sm text-muted-foreground",t),...r})});o.displayName="CardDescription";let c=r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)("div",{ref:a,className:(0,l.cn)("p-6 pt-0",t),...r})});c.displayName="CardContent";let u=r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)("div",{ref:a,className:(0,l.cn)("flex items-center p-6 pt-0",t),...r})});u.displayName="CardFooter"},9026:(e,a,t)=>{t.d(a,{Fc:()=>d,TN:()=>c,XL:()=>o});var s=t(5155),r=t(2115),l=t(2085),i=t(3999);let n=(0,l.F)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),d=r.forwardRef((e,a)=>{let{className:t,variant:r,...l}=e;return(0,s.jsx)("div",{ref:a,role:"alert",className:(0,i.cn)(n({variant:r}),t),...l})});d.displayName="Alert";let o=r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)("h5",{ref:a,className:(0,i.cn)("mb-1 font-medium leading-none tracking-tight",t),...r})});o.displayName="AlertTitle";let c=r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)("div",{ref:a,className:(0,i.cn)("text-sm [&_p]:leading-relaxed",t),...r})});c.displayName="AlertDescription"}}]);