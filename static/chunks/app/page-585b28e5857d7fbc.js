(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{2262:(e,t,a)=>{Promise.resolve().then(a.bind(a,8704)),Promise.resolve().then(a.bind(a,7457))},7457:(e,t,a)=>{"use strict";a.d(t,{default:()=>el});var r=a(5155),s=a(2115),l=a(5982),n=a(7168),i=a(1154),o=a(4449),c=a(381),d=a(2355),u=a(3052),m=a(1007),h=a(2108),f=a(6516),x=a(1788),g=a(1992),p=a(6474),b=a(7863),y=a(5196),w=a(3999);let v=g.bL;g.YJ;let j=g.WT,N=s.forwardRef((e,t)=>{let{className:a,children:s,...l}=e;return(0,r.jsxs)(g.l9,{ref:t,className:(0,w.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",a),...l,children:[s,(0,r.jsx)(g.In,{asChild:!0,children:(0,r.jsx)(p.A,{className:"h-4 w-4 opacity-50"})})]})});N.displayName=g.l9.displayName;let k=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(g.PP,{ref:t,className:(0,w.cn)("flex cursor-default items-center justify-center py-1",a),...s,children:(0,r.jsx)(b.A,{className:"h-4 w-4"})})});k.displayName=g.PP.displayName;let C=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(g.wn,{ref:t,className:(0,w.cn)("flex cursor-default items-center justify-center py-1",a),...s,children:(0,r.jsx)(p.A,{className:"h-4 w-4"})})});C.displayName=g.wn.displayName;let S=s.forwardRef((e,t)=>{let{className:a,children:s,position:l="popper",...n}=e;return(0,r.jsx)(g.ZL,{children:(0,r.jsxs)(g.UC,{ref:t,className:(0,w.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===l&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",a),position:l,...n,children:[(0,r.jsx)(k,{}),(0,r.jsx)(g.LM,{className:(0,w.cn)("p-1","popper"===l&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:s}),(0,r.jsx)(C,{})]})})});S.displayName=g.UC.displayName,s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(g.JU,{ref:t,className:(0,w.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",a),...s})}).displayName=g.JU.displayName;let A=s.forwardRef((e,t)=>{let{className:a,children:s,...l}=e;return(0,r.jsxs)(g.q7,{ref:t,className:(0,w.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...l,children:[(0,r.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,r.jsx)(g.VF,{children:(0,r.jsx)(y.A,{className:"h-4 w-4"})})}),(0,r.jsx)(g.p4,{children:s})]})});A.displayName=g.q7.displayName,s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(g.wv,{ref:t,className:(0,w.cn)("-mx-1 my-1 h-px bg-muted",a),...s})}).displayName=g.wv.displayName;var E=a(4073);let R=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsxs)(E.bL,{ref:t,className:(0,w.cn)("relative flex w-full touch-none select-none items-center",a),...s,children:[(0,r.jsx)(E.CC,{className:"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary",children:(0,r.jsx)(E.Q6,{className:"absolute h-full bg-primary"})}),(0,r.jsx)(E.zi,{className:"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50"})]})});R.displayName=E.bL.displayName;var M=a(5600),P=a(5452),z=a(4416);let T=P.bL,D=P.l9,L=P.ZL;P.bm;let U=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(P.hJ,{ref:t,className:(0,w.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...s})});U.displayName=P.hJ.displayName;let F=s.forwardRef((e,t)=>{let{className:a,children:s,...l}=e;return(0,r.jsxs)(L,{children:[(0,r.jsx)(U,{}),(0,r.jsxs)(P.UC,{ref:t,className:(0,w.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...l,children:[s,(0,r.jsxs)(P.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,r.jsx)(z.A,{className:"h-4 w-4"}),(0,r.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});F.displayName=P.UC.displayName,s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(P.hE,{ref:t,className:(0,w.cn)("text-lg font-semibold leading-none tracking-tight",a),...s})}).displayName=P.hE.displayName,s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(P.VY,{ref:t,className:(0,w.cn)("text-sm text-muted-foreground",a),...s})}).displayName=P.VY.displayName;var I=a(8032),B=a(4503),V=a(5339),$=a(3127),_=a(8495),W=a(402),O=a(2998),q=a(2152),J=a(5273),Y=a(9389),H=a(4695),Q=a(8833),G=a(6675),K=a(1362);function X(e){let{audioUrl:t,isPlaying:a,currentTime:l,duration:n,onSeek:i,className:o,theme:c}=e,d=(0,s.useRef)(null),u=(0,s.useRef)(null),[m,h]=(0,s.useState)(null),[f,x]=(0,s.useState)(!1),[g,p]=(0,s.useState)(null),b=(0,s.useRef)(),y=(0,s.useRef)(null);(0,s.useRef)(null);let v=(0,s.useRef)(null),{theme:j}=(0,K.D)(),N="dark"===j,[k,C]=(0,s.useState)(0),S=()=>{let e=new Float32Array(100);for(let t=0;t<100;t++)e[t]=.1+.1*Math.sin(t/100*Math.PI*10);return e};return(0,s.useEffect)(()=>{if(!t){h(S()),p("No audio available");return}let e=async()=>{try{if(x(!0),p(null),!y.current)try{y.current=new(window.AudioContext||window.webkitAudioContext)}catch(e){console.error("Failed to create audio context:",e),p("Your browser doesn't support audio visualization"),h(S()),x(!1);return}try{let e="".concat(t).concat(t.includes("?")?"&":"?","_t=").concat(Date.now()),a=await fetch(e,{method:"GET",headers:{Accept:"audio/*"}});if(!a.ok){if(404===a.status)throw Error("Audio file not found (404)");throw Error("HTTP error! Status: ".concat(a.status))}try{let e=await a.arrayBuffer();try{let t=(await y.current.decodeAudioData(e)).getChannelData(0),a=Math.max(1,Math.floor(t.length/1e3)),r=[];for(let e=0;e<t.length;e+=a){let s=0;for(let r=0;r<a&&e+r<t.length;r++){let a=Math.abs(t[e+r]);a>s&&(s=a)}r.push(s)}h(new Float32Array(r))}catch(e){throw console.error("Error decoding audio data:",e),p("Couldn't process audio for visualization"),h(S()),e}}catch(e){throw console.error("Error processing audio data:",e),p("Couldn't process audio data"),h(S()),e}}catch(t){if(console.error("Error fetching audio:",t),k<2){C(e=>e+1),p("Retrying... (".concat(k+1,"/").concat(2,")")),setTimeout(()=>{e()},1e3);return}p("Couldn't load audio file. Using placeholder visualization."),h(S())}x(!1)}catch(e){console.error("Error loading audio for visualization:",e),p("Failed to load audio visualization"),h(S()),x(!1)}};return e(),()=>{v.current&&v.current.disconnect(),b.current&&cancelAnimationFrame(b.current)}},[t,k,2]),(0,s.useEffect)(()=>{if(!d.current||!m||!u.current)return;let e=d.current,t=e.getContext("2d");if(!t)return;let a=window.devicePixelRatio||1,r=u.current.getBoundingClientRect();e.width=r.width*a,e.height=r.height*a,t.scale(a,a),e.style.width="".concat(r.width,"px"),e.style.height="".concat(r.height,"px");let s=r.width,i=r.height;t.clearRect(0,0,s,i);let o=n>0?l/n*s:0,h=c.primary,f=N&&"monochrome"===c.name?"rgb(75, 85, 99)":c.secondary,x=c.gradient,g=Math.max(1,s/m.length-1),p=null;"monochrome"!==c.name&&c.gradient.length>1&&(p=t.createLinearGradient(0,0,o,0),x.forEach((e,t)=>{p.addColorStop(t/(x.length-1),e)}));for(let e=0;e<m.length;e++){let a=e*(g+1),r=m[e]*i*.8;if(a<o){if(p&&"monochrome"!==c.name){let e=Math.floor(a/o*x.length);t.fillStyle=x[Math.min(e,x.length-1)]}else t.fillStyle=h}else t.fillStyle=f;let s=(i-r)/2;t.fillRect(a,s,g,r)}},[m,l,n,c,N]),(0,r.jsxs)("div",{ref:u,className:(0,w.cn)("relative w-full h-16 bg-gray-100 dark:bg-gray-800 rounded-md overflow-hidden",o),children:[f&&(0,r.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-gray-100/50 dark:bg-gray-800/50",children:(0,r.jsx)("div",{className:"w-5 h-5 border-2 border-t-transparent rounded-full animate-spin",style:{borderColor:c.primary,borderTopColor:"transparent"}})}),g&&(0,r.jsxs)("div",{className:"absolute top-0 right-0 p-1 bg-gray-100/80 dark:bg-gray-800/80 text-xs text-amber-600 dark:text-amber-400 rounded-bl-md flex items-center",children:[(0,r.jsx)(V.A,{className:"h-3 w-3 mr-1"}),g]}),(0,r.jsx)("canvas",{ref:d,className:"w-full h-full cursor-pointer",onClick:e=>{if(!u.current||!n)return;let t=u.current.getBoundingClientRect();i((e.clientX-t.left)/t.width*n)}}),(0,r.jsx)("div",{className:"absolute top-0 bottom-0 w-0.5 pointer-events-none",style:{left:"".concat(n>0?l/n*100:0,"%"),transition:a?"none":"left 0.1s ease-out",backgroundColor:c.primary}})]})}function Z(e){let{audioRef:t,isPlaying:a,className:l,barCount:n=64,theme:i,visualizationType:o="bars"}=e,c=(0,s.useRef)(null),[d,u]=(0,s.useState)(null),[m,h]=(0,s.useState)(null),[f,x]=(0,s.useState)(null),g=(0,s.useRef)(),p=(0,s.useRef)(null),{theme:b}=(0,K.D)(),y="dark"===b;return(0,s.useEffect)(()=>{if(t.current)return d||(()=>{try{let e=new(window.AudioContext||window.webkitAudioContext);u(e);let a=e.createAnalyser();a.fftSize=2*n,a.smoothingTimeConstant=.8,h(a);let r=a.frequencyBinCount,s=new Uint8Array(r);x(s);let l=e.createMediaElementSource(t.current);l.connect(a),a.connect(e.destination),p.current=l}catch(e){console.error("Error initializing audio visualizer:",e)}})(),()=>{p.current&&p.current.disconnect(),g.current&&cancelAnimationFrame(g.current),d&&d.close()}},[t,d,n]),(0,s.useEffect)(()=>{let e;if(!m||!f||!c.current)return;let t=c.current,r=t.getContext("2d");if(!r)return;let s=window.devicePixelRatio||1,l=t.getBoundingClientRect();t.width=l.width*s,t.height=l.height*s,r.scale(s,s),t.style.width="".concat(l.width,"px"),t.style.height="".concat(l.height,"px");let d=l.width,u=l.height,h=i.primary,x=y&&"monochrome"===i.name?"rgb(75, 85, 99)":i.secondary,p=i.gradient,b=()=>{if(e=requestAnimationFrame(b),m.getByteFrequencyData(f),r.clearRect(0,0,d,u),"bars"===o){let e=d/n;for(let t=0;t<n;t++){let s=f[t]/255*u*.8;if(a){if("rainbow"===i.name){let e=t/n*360;r.fillStyle="hsl(".concat(e,", 70%, 60%)")}else{let e=Math.floor(t/n*p.length);r.fillStyle=p[e%p.length]}}else r.fillStyle=x;let l=t*e,o=(u-s)/2;r.fillRect(l,o,e-1,s)}}else if("wave"===o){if(r.beginPath(),r.moveTo(0,u/2),a&&"monochrome"!==i.name){let e=r.createLinearGradient(0,0,d,0);p.forEach((t,a)=>{e.addColorStop(a/(p.length-1),t)}),r.strokeStyle=e}else r.strokeStyle=a?h:x;for(let e=0;e<n;e++){let t=e/n*d,a=u/2+(f[e]/255-.5)*u*.8;r.lineTo(t,a)}r.lineTo(d,u/2),r.lineWidth=2,r.stroke()}else if("circle"===o){let e=d/2,t=u/2,s=Math.min(d,u)/3;r.beginPath(),r.arc(e,t,s,0,2*Math.PI),r.strokeStyle=x,r.lineWidth=2,r.stroke();for(let l=0;l<n;l++){let o=f[l]/255*s*.5,c=l/n*2*Math.PI,d=e+Math.cos(c)*s,u=t+Math.sin(c)*s,m=e+Math.cos(c)*(s+o),h=t+Math.sin(c)*(s+o);if(r.beginPath(),r.moveTo(d,u),r.lineTo(m,h),a){if("rainbow"===i.name){let e=l/n*360;r.strokeStyle="hsl(".concat(e,", 70%, 60%)")}else{let e=Math.floor(l/n*p.length);r.strokeStyle=p[e%p.length]}}else r.strokeStyle=x;r.lineWidth=2,r.stroke()}}};if(a)b();else if(r.clearRect(0,0,d,u),"bars"===o){let e=d/n;for(let t=0;t<n;t++){let a=Math.sin(t/n*Math.PI)*u*.3;r.fillStyle=x;let s=t*e,l=(u-a)/2;r.fillRect(s,l,e-1,a)}}else if("wave"===o){r.beginPath(),r.moveTo(0,u/2);for(let e=0;e<n;e++){let t=e/n*d,a=u/2+Math.sin(e/n*Math.PI*4)*u*.1;r.lineTo(t,a)}r.strokeStyle=x,r.lineWidth=2,r.stroke()}else if("circle"===o){let e=d/2,t=Math.min(d,u)/3;r.beginPath(),r.arc(e,u/2,t,0,2*Math.PI),r.strokeStyle=x,r.lineWidth=2,r.stroke()}return g.current=e,()=>{e&&cancelAnimationFrame(e)}},[m,f,a,i,y,n,o]),(0,r.jsx)("div",{className:(0,w.cn)("relative w-full h-24 bg-gray-100 dark:bg-gray-800 rounded-md overflow-hidden",l),children:(0,r.jsx)("canvas",{ref:c,className:"w-full h-full"})})}var ee=a(7133);let et=[{name:"emerald",primary:"rgb(16, 185, 129)",secondary:"rgb(209, 250, 229)",accent:"rgb(4, 120, 87)",gradient:["rgb(16, 185, 129)","rgb(5, 150, 105)","rgb(4, 120, 87)"],description:"Default emerald theme"},{name:"blue",primary:"rgb(37, 99, 235)",secondary:"rgb(219, 234, 254)",accent:"rgb(30, 64, 175)",gradient:["rgb(37, 99, 235)","rgb(59, 130, 246)","rgb(30, 64, 175)"],description:"Calm blue theme"},{name:"purple",primary:"rgb(147, 51, 234)",secondary:"rgb(243, 232, 255)",accent:"rgb(107, 33, 168)",gradient:["rgb(147, 51, 234)","rgb(168, 85, 247)","rgb(107, 33, 168)"],description:"Vibrant purple theme"},{name:"sunset",primary:"rgb(249, 115, 22)",secondary:"rgb(255, 237, 213)",accent:"rgb(194, 65, 12)",gradient:["rgb(249, 115, 22)","rgb(234, 88, 12)","rgb(194, 65, 12)"],description:"Warm sunset theme"},{name:"rainbow",primary:"rgb(37, 99, 235)",secondary:"rgb(219, 234, 254)",accent:"rgb(16, 185, 129)",gradient:["rgb(239, 68, 68)","rgb(249, 115, 22)","rgb(234, 179, 8)","rgb(16, 185, 129)","rgb(37, 99, 235)","rgb(147, 51, 234)"],description:"Colorful rainbow theme"},{name:"monochrome",primary:"rgb(75, 85, 99)",secondary:"rgb(229, 231, 235)",accent:"rgb(31, 41, 55)",gradient:["rgb(75, 85, 99)","rgb(107, 114, 128)","rgb(31, 41, 55)"],description:"Minimalist monochrome theme"},{name:"neon",primary:"rgb(236, 72, 153)",secondary:"rgb(253, 242, 248)",accent:"rgb(67, 56, 202)",gradient:["rgb(236, 72, 153)","rgb(67, 56, 202)","rgb(16, 185, 129)"],description:"Vibrant neon theme"}];function ea(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"english",a=M.oh.find(t=>t.id===e)||null;return a?a.name[t]||a.name.english:null}var er=a(9026);function es(e){let{src:t,onTimeUpdate:a,onEnded:o,onNext:c,onPrev:d,className:u}=e,[m,h]=(0,s.useState)(!1),[f,x]=(0,s.useState)(!1),[g,p]=(0,s.useState)(.8),[b,y]=(0,s.useState)(0),[v,j]=(0,s.useState)(0),[N,k]=(0,s.useState)(!0),[C,S]=(0,s.useState)(null),[A,E]=(0,s.useState)("waveform"),[P,z]=(0,s.useState)(et[0]),[T,D]=(0,s.useState)(null),{currentLanguage:L,currentSurah:U,currentReciter:F}=(0,l.d)(),I=(0,s.useRef)(null),B=(0,s.useRef)(!0),K=(0,s.useRef)(0),[es,el]=(0,s.useState)(t),[en,ei]=(0,s.useState)(!1),eo=(0,s.useCallback)(()=>{I.current&&es&&(m?I.current.pause():(S(null),I.current.play().catch(e=>{console.error("Error playing audio:",e.message||"Unknown error"),"NotAllowedError"===e.name?S("Browser blocked autoplay. Please click play again."):"NotSupportedError"===e.name?S("Audio format not supported by your browser."):S("Couldn't play audio. Please try again.")})))},[m,es]),ec=(0,s.useCallback)(()=>{I.current&&(I.current.muted=!f,x(!f))},[f]);(0,s.useEffect)(()=>{if(k(!0),S(null),y(0),h(!1),K.current=0,el(t),ei(!1),t){let e=function(e){if(!e)return null;try{let t=e.match(/server\d+\.mp3quran\.net\/([^/]+)\//);if(t&&t[1]){let e=t[1],a=M.oh.find(t=>{let a=t.audioBaseUrl.match(/\/([^/]+)\/$/);return a&&a[1]===e});return a?a.id:null}for(let t of M.oh)if(e.includes(t.audioBaseUrl))return t.id;return null}catch(e){return console.error("Error extracting reciter from URL:",e),null}}(t);e?D(ea(e,L)):D(null)}else D(null)},[t,L]),(0,s.useEffect)(()=>{let e=e=>{let t=document.activeElement;if(!(t instanceof HTMLInputElement||t instanceof HTMLTextAreaElement||t instanceof HTMLSelectElement))switch(e.key){case" ":case"k":e.preventDefault(),eo();break;case"ArrowRight":e.shiftKey&&c?(e.preventDefault(),c()):I.current&&(e.preventDefault(),I.current.currentTime+=5);break;case"ArrowLeft":e.shiftKey&&d?(e.preventDefault(),d()):I.current&&(e.preventDefault(),I.current.currentTime-=5);break;case"m":e.preventDefault(),ec();break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":if(I.current){e.preventDefault();let t=Number.parseInt(e.key)/10;I.current.currentTime=v*t}}};return window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}},[v,c,d,eo,ec]),(0,s.useEffect)(()=>{if(!I.current||B.current){B.current=!1;return}let e=I.current;e.volume=g,e.muted=f,!es||N||C||e.play().catch(e=>{console.error("Error auto-playing audio:",e)})},[es,N,C,g,f]);let ed=(0,s.useCallback)(e=>{let t=e[0];p(t),I.current&&(I.current.volume=t)},[]),eu=(0,s.useCallback)(()=>{if(!I.current)return;let e=I.current.currentTime;y(e),null==a||a(e)},[a]),em=(0,s.useCallback)(e=>{I.current&&(I.current.currentTime=e,y(e))},[]),eh=(0,s.useCallback)(e=>{let t=Math.floor(e/60),a=Math.floor(e%60);return"".concat(t,":").concat(a<10?"0":"").concat(a)},[]),ef=(0,s.useCallback)(async()=>{if(!U||!F||en)return!1;try{S("Trying alternative audio source...");let e=await (0,M.Lx)(U,F);if(e&&e!==es)return console.log("Using alternative audio source:",e),el(e),ei(!0),!0}catch(e){console.error("Error getting alternative audio source:",e)}return!1},[U,F,es,en]),ex=(0,s.useCallback)(async()=>{if(I.current){let e=I.current.error?I.current.error.code:0,t="Unknown error occurred";switch(e){case 1:t="Audio loading was aborted";break;case 2:t="Network error occurred while loading audio";break;case 3:t="Audio decoding failed";break;case 4:if(t="Audio format not supported",await ef())return}console.error("Audio error:",t,e),(2===e||4===e)&&K.current<2&&es?(K.current+=1,S("Audio loading failed. Retrying... (".concat(K.current,"/").concat(2,")")),setTimeout(()=>{if(I.current&&es){let e="".concat(es).concat(es.includes("?")?"&":"?","_t=").concat(Date.now());I.current.src=e,I.current.load()}},1e3)):en?S("".concat(t,". Please try another surah or reciter.")):ef().then(e=>{e||S("".concat(t,". Please try another surah or reciter."))})}else S("Failed to load audio. Please try again.");k(!1)},[es,ef,en]);return(0,r.jsxs)("div",{className:(0,w.cn)("w-full space-y-4",u),children:[(0,r.jsx)("audio",{ref:I,src:es||void 0,onPlay:()=>h(!0),onPause:()=>h(!1),onTimeUpdate:eu,onLoadStart:()=>k(!0),onLoadedMetadata:()=>{I.current&&(j(I.current.duration),k(!1))},onCanPlay:()=>k(!1),onEnded:()=>{h(!1),null==o||o()},onError:ex,preload:"metadata",crossOrigin:"anonymous"}),C&&(0,r.jsxs)(er.Fc,{variant:"destructive",className:"mb-2",children:[(0,r.jsx)(V.A,{className:"h-4 w-4"}),(0,r.jsx)(er.TN,{children:C})]}),T&&(0,r.jsx)("div",{className:"text-sm text-gray-500 dark:text-gray-400 flex items-center",children:(0,r.jsxs)("span",{children:["Reciter: ",T]})}),(0,r.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsxs)(ee.rI,{children:[(0,r.jsx)(ee.ty,{asChild:!0,children:(0,r.jsxs)(n.$,{variant:"outline",size:"sm",className:"h-8",children:[(0,r.jsx)($.A,{className:"h-4 w-4 mr-2"}),P.name.charAt(0).toUpperCase()+P.name.slice(1)]})}),(0,r.jsx)(ee.SQ,{children:et.map(e=>(0,r.jsxs)(ee._2,{onClick:()=>z(e),className:"flex items-center",children:[(0,r.jsx)("div",{className:"w-4 h-4 rounded-full mr-2",style:{background:"rainbow"===e.name?"linear-gradient(to right, red, orange, yellow, green, blue, purple)":e.primary}}),e.name.charAt(0).toUpperCase()+e.name.slice(1)]},e.name))})]}),(0,r.jsxs)(ee.rI,{children:[(0,r.jsx)(ee.ty,{asChild:!0,children:(0,r.jsxs)(n.$,{variant:"outline",size:"sm",className:"h-8",children:["bars"===A&&(0,r.jsx)(_.A,{className:"h-4 w-4 mr-2"}),"wave"===A&&(0,r.jsx)(W.A,{className:"h-4 w-4 mr-2"}),"circle"===A&&(0,r.jsx)(O.A,{className:"h-4 w-4 mr-2"}),"waveform"===A&&(0,r.jsx)(W.A,{className:"h-4 w-4 mr-2"}),A.charAt(0).toUpperCase()+A.slice(1)]})}),(0,r.jsxs)(ee.SQ,{children:[(0,r.jsxs)(ee._2,{onClick:()=>E("waveform"),children:[(0,r.jsx)(W.A,{className:"h-4 w-4 mr-2"})," Waveform"]}),(0,r.jsxs)(ee._2,{onClick:()=>E("bars"),children:[(0,r.jsx)(_.A,{className:"h-4 w-4 mr-2"})," Bars"]}),(0,r.jsxs)(ee._2,{onClick:()=>E("wave"),children:[(0,r.jsx)(W.A,{className:"h-4 w-4 mr-2"})," Wave"]}),(0,r.jsxs)(ee._2,{onClick:()=>E("circle"),children:[(0,r.jsx)(O.A,{className:"h-4 w-4 mr-2"})," Circle"]})]})]})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("span",{className:"text-sm",children:eh(b)}),(0,r.jsx)("span",{className:"text-sm text-gray-500",children:"/"}),(0,r.jsx)("span",{className:"text-sm",children:eh(v)})]})]}),(0,r.jsx)("div",{className:"w-full h-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden cursor-pointer",onClick:e=>{let t=e.currentTarget.getBoundingClientRect();em((e.clientX-t.left)/t.width*v)},children:(0,r.jsx)("div",{className:"h-full transition-all duration-100",style:{width:"".concat(b/v*100||0,"%"),backgroundColor:P.primary}})}),"waveform"===A?(0,r.jsx)(X,{audioUrl:es,isPlaying:m,currentTime:b,duration:v,onSeek:em,className:"h-24",theme:P}):(0,r.jsx)(Z,{audioRef:I,isPlaying:m,visualizationType:A,className:"h-24",theme:P}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(n.$,{variant:"ghost",size:"icon",onClick:ec,title:f?"Unmute":"Mute",children:f?(0,r.jsx)(q.A,{className:"h-4 w-4"}):(0,r.jsx)(J.A,{className:"h-4 w-4"})}),(0,r.jsx)(R,{className:"w-24",value:[g],min:0,max:1,step:.01,onValueChange:ed,"aria-label":"Volume"})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(n.$,{variant:"outline",size:"icon",onClick:d,disabled:!d,title:"Previous verse (Left Arrow)",children:(0,r.jsx)(Y.A,{className:"h-4 w-4"})}),(0,r.jsx)(n.$,{variant:"default",size:"icon",onClick:eo,disabled:N||!es,className:"text-white",style:{backgroundColor:P.primary},title:m?"Pause (Space)":"Play (Space)",children:N?(0,r.jsx)(i.A,{className:"h-4 w-4 animate-spin"}):m?(0,r.jsx)(H.A,{className:"h-4 w-4"}):(0,r.jsx)(Q.A,{className:"h-4 w-4"})}),(0,r.jsx)(n.$,{variant:"outline",size:"icon",onClick:c,disabled:!c,title:"Next verse (Right Arrow)",children:(0,r.jsx)(G.A,{className:"h-4 w-4"})})]})]}),(0,r.jsx)("div",{className:"text-xs text-gray-500 dark:text-gray-400 text-center mt-2",children:(0,r.jsx)("p",{children:"Keyboard shortcuts: Space (play/pause), ← → (seek), m (mute), 0-9 (jump to position)"})})]})}function el(){let{currentSurah:e,currentVerse:t,setCurrentSurah:a,setCurrentVerse:g,currentLanguage:p,currentReciter:b,setCurrentReciter:y,isLoading:k,isOffline:C,surahs:E,surahData:P,getAllReciters:z,getAudioForSurah:L,refreshSurahs:U}=(0,l.d)(),{toast:V}=(0,B.d)(),[$,_]=(0,s.useState)(24),[W,O]=(0,s.useState)(null),[q,J]=(0,s.useState)(!1),[Y,H]=(0,s.useState)(!1),[Q,G]=(0,s.useState)(!1);(0,s.useRef)(null);let K=z(),X=(0,s.useCallback)(()=>{P&&(t<P.verses.length?g(t+1):e<E.length&&(a(e+1),g(1)))},[t,e,P,E.length,g,a]),Z=(0,s.useCallback)(()=>{t>1?g(t-1):e>1&&(a(e-1),g(1))},[t,e,g,a]),ee=(0,s.useCallback)(e=>{if(P&&P.verses){let a=P.verses.findIndex(t=>t.timestamp>e);if(a>0){let e=P.verses[a-1].id;e!==t&&g(e)}else if(-1===a&&e>0){let e=P.verses[P.verses.length-1].id;e!==t&&g(e)}}},[t,g,P]);(0,s.useEffect)(()=>{(async function(){if(P){G(!0),O(null);try{let t=await L(e,b);if(!t)throw Error("No audio URL available");O(t)}catch(e){console.error("Error loading audio:",e instanceof Error?e.message:String(e)),V({title:"Audio Error",description:"Failed to load audio recitation. Please try another reciter or surah.",variant:"destructive"})}finally{G(!1)}}})()},[e,b,P,L,V]),(0,s.useEffect)(()=>{let e=document.getElementById("verse-".concat(t));e&&e.scrollIntoView({behavior:"smooth",block:"center"})},[t]);let et=async()=>{if(C){V({title:"Offline",description:"You need to be online to download surahs",variant:"destructive"});return}if(P){J(!0);try{await (0,M.c1)(e,b)?(V({title:"Download Complete",description:"Surah ".concat(e," is now available offline")}),await U()):V({title:"Download Failed",description:"Failed to download surah",variant:"destructive"})}catch(e){console.error("Download error:",e),V({title:"Download Error",description:"An error occurred during download",variant:"destructive"})}finally{J(!1)}}},er=async()=>{if(navigator.share)try{await navigator.share({title:"Quran - Surah ".concat(null==P?void 0:P.name.english),text:"Reading Surah ".concat(null==P?void 0:P.name.english,", Verse ").concat(t),url:window.location.href})}catch(e){console.error("Error sharing:",e)}else V({title:"Share",description:"Copy the URL to share this surah"})};return k||!P?(0,r.jsxs)("div",{className:"flex items-center justify-center h-64",children:[(0,r.jsx)(i.A,{className:"h-8 w-8 animate-spin text-emerald-600 dark:text-emerald-400"}),(0,r.jsx)("span",{className:"ml-2 text-lg",children:"Loading Surah..."})]}):(0,r.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,r.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6 mb-6 text-center",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,r.jsx)("h2",{className:"text-3xl font-bold",children:"arabic"===p?P.name.arabic:"kurdish"===p&&P.name.kurdish||P.name.english}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[C&&(0,r.jsxs)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-amber-100 text-amber-800 dark:bg-amber-900/30 dark:text-amber-300",children:[(0,r.jsx)(o.A,{className:"w-3 h-3 mr-1"})," Offline"]}),(0,r.jsxs)(T,{open:Y,onOpenChange:H,children:[(0,r.jsx)(D,{asChild:!0,children:(0,r.jsxs)(n.$,{variant:"outline",size:"sm",children:[(0,r.jsx)(c.A,{className:"w-4 h-4 mr-2"})," Offline Settings"]})}),(0,r.jsx)(F,{className:"max-w-3xl max-h-[80vh] overflow-y-auto",children:(0,r.jsx)(I.F,{onClose:()=>H(!1)})})]})]})]}),(0,r.jsxs)("p",{className:"text-gray-600 dark:text-gray-300",children:[P.revelation," • ",P.verses.length," Verses"]}),P.bismillah&&(0,r.jsx)("div",{className:(0,w.cn)("mt-6 mb-2 text-center","arabic"===p?"font-amiri":""),style:{fontSize:"".concat($,"px")},children:"arabic"===p?"بِسْمِ اللَّهِ الرَّحْمَٰنِ الرَّحِيمِ":"kurdish"===p?"بە ناوی خودای بەخشندەی میهرەبان":"In the name of Allah, the Entirely Merciful, the Especially Merciful"})]}),(0,r.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 mb-6",children:[(0,r.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-4",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(n.$,{variant:"outline",size:"icon",onClick:Z,"aria-label":"Previous verse",children:(0,r.jsx)(d.A,{className:"h-4 w-4"})}),(0,r.jsxs)(v,{value:e.toString(),onValueChange:e=>{a(Number.parseInt(e)),g(1)},children:[(0,r.jsx)(N,{className:"w-[180px]",children:(0,r.jsx)(j,{placeholder:"Select Surah"})}),(0,r.jsx)(S,{className:"max-h-[300px]",children:E.map(e=>(0,r.jsxs)(A,{value:e.id.toString(),children:[e.id,". ","arabic"===p?e.name.arabic:e.name.english,e.isDownloaded&&" ✓"]},e.id))})]}),(0,r.jsx)(n.$,{variant:"outline",size:"icon",onClick:X,"aria-label":"Next verse",children:(0,r.jsx)(u.A,{className:"h-4 w-4"})})]}),(0,r.jsx)("div",{className:"flex items-center space-x-2",children:(0,r.jsxs)(v,{value:b,onValueChange:y,children:[(0,r.jsx)(N,{className:"w-[180px]",children:(0,r.jsx)(j,{placeholder:"Select Reciter"})}),(0,r.jsx)(S,{children:K.map(e=>(0,r.jsx)(A,{value:e.id,children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(m.A,{className:"h-4 w-4 mr-2 text-gray-500"}),ea(e.id,p)]})},e.id))})]})}),(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("span",{className:"text-sm",children:"A-"}),(0,r.jsx)(R,{className:"w-24",value:[$],min:16,max:40,step:1,onValueChange:e=>_(e[0]),"aria-label":"Font size"}),(0,r.jsx)("span",{className:"text-sm",children:"A+"})]}),(0,r.jsx)(n.$,{variant:"outline",size:"icon","aria-label":"Bookmark",children:(0,r.jsx)(h.A,{className:"h-4 w-4"})}),(0,r.jsx)(n.$,{variant:"outline",size:"icon",onClick:er,"aria-label":"Share",children:(0,r.jsx)(f.A,{className:"h-4 w-4"})}),!P.isDownloaded&&(0,r.jsx)(n.$,{variant:"outline",size:"icon",onClick:et,disabled:C||q,title:"Download for offline use","aria-label":"Download for offline use",children:q?(0,r.jsx)(i.A,{className:"h-4 w-4 animate-spin"}):(0,r.jsx)(x.A,{className:"h-4 w-4"})})]})]}),(0,r.jsx)("div",{className:"mt-4 border-t pt-4 dark:border-gray-700",children:(0,r.jsx)(es,{src:W,onTimeUpdate:ee,onEnded:()=>{X()},onNext:X,onPrev:Z})})]}),(0,r.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6",children:(0,r.jsx)("div",{className:"space-y-6",children:P.verses.map(e=>(0,r.jsx)("div",{id:"verse-".concat(e.id),className:(0,w.cn)("pb-6 border-b last:border-0 dark:border-gray-700",t===e.id?"bg-emerald-50 dark:bg-emerald-900/20 -mx-6 px-6 py-4 rounded-md":""),children:(0,r.jsxs)("div",{className:"flex items-start mb-4",children:[(0,r.jsx)("div",{className:"flex items-center justify-center w-10 h-10 rounded-full bg-emerald-100 dark:bg-emerald-900/30 text-emerald-800 dark:text-emerald-200 font-medium flex-shrink-0 mr-4",children:e.id}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("p",{className:(0,w.cn)("mb-4 leading-relaxed","arabic"===p?"font-amiri text-right":"","kurdish"===p?"text-right":""),style:{fontSize:"".concat($,"px"),direction:"arabic"===p||"kurdish"===p?"rtl":"ltr"},children:e[p]||e.arabic}),"english"!==p&&(0,r.jsx)("p",{className:"text-gray-600 dark:text-gray-300 text-sm leading-relaxed",children:e.english}),"arabic"!==p&&(0,r.jsx)("p",{className:"font-amiri text-gray-600 dark:text-gray-300 text-right mt-2 leading-relaxed",style:{fontSize:"".concat(Math.max($-4,16),"px")},dir:"rtl",children:e.arabic})]})]})},e.id))})})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[800,338,770,823,709,496,704,32,441,684,358],()=>t(2262)),_N_E=e.O()}]);